<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üìä –†–µ–π—Ç–∏–Ω–≥ –≤—É–∑–æ–≤ –ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫–∞</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<body>
    <header>
        <h1>üìä –†–µ–π—Ç–∏–Ω–≥ –≤—É–∑–æ–≤ –ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫–∞</h1>
        <p>–ö–∞–∫ –º—ã —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–π—Ç–∏–Ω–≥?</p>
    </header>
    <nav>
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="rating.html">–†–µ–π—Ç–∏–Ω–≥</a>
        <a href="universities.html">–í—É–∑—ã</a>
        <a href="reviews.html">–û—Ç–∑—ã–≤—ã</a>
        <a href="contact.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    </nav>
    <main class="container">
        <h2>–¢–û–ü-5 –í–£–ó–æ–≤ –ø–æ –≤–µ—Ä—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
        <table id="rating-table">
            <thead>
            <tr><th>#</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ –≤—É–∑–∞</th><th>–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞</th></tr>
            </thead>
            <tbody></tbody>
        </table>
    </main>
    <footer>
        &copy; 2025 ‚Äî –†–µ–π—Ç–∏–Ω–≥ –≤—É–∑–æ–≤ –ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫–∞ | –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã
    </footer>
    
    <script>
        const owner = "NomixXx"; // ‚Üê –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π –ª–æ–≥–∏–Ω
        const repo = "vuz-rating";
        const filePath = "reviews.json";
        const token = "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";
    
        async function fetchReviews() {
            const response = await fetch(`https://api.github.com/repos/ ${owner}/${repo}/contents/${filePath}`, {
                headers: {
                    Authorization: `token ${token}`,
                    Accept: "application/vnd.github.v3.raw"
                }
            });
            const data = await response.json();
            return JSON.parse(atob(data.content));
        }
    
        async function calculateRatings() {
            const reviews = await fetchReviews();
    
            const ratings = {};
    
            reviews.forEach(review => {
                const univ = review.university;
                const score = parseFloat(review.rating);
    
                if (!ratings[univ]) {
                    ratings[univ] = { total: 0, count: 0 };
                }
                ratings[univ].total += score;
                ratings[univ].count += 1;
            });
    
            const sorted = Object.keys(ratings)
                .map(name => ({
                    name,
                    avg: (ratings[name].total / ratings[name].count).toFixed(2)
                }))
                .sort((a, b) => b.avg - a.avg);
    
            const tbody = document.querySelector("#rating-table tbody");
            tbody.innerHTML = "";
    
            sorted.forEach((item, index) => {
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.name}</td>
                    <td>‚≠ê ${item.avg}</td>
                `;
                tbody.appendChild(tr);
            });
        }
    
        window.onload = calculateRatings;
    </script>
    </body>
</body>
</html>
